{% stylesheet %}
<style>
.bundle-offer {
  border: 1px solid #e0e0e0;
  padding: 20px;
  border-radius: 12px;
  background: #f9f9f9;
  max-width: 600px;
  margin: auto;
}

.bundle-offer h2 {
  font-size: 24px;
  margin-bottom: 20px;
  text-align: center;
}

.bundle-option {
  display: flex;
  justify-content: space-between;
  align-items: center;
  border: 1px solid #ccc;
  padding: 16px;
  border-radius: 8px;
  margin-bottom: 12px;
  background: #fff;
  cursor: pointer;
}

.bundle-option input {
  margin-right: 12px;
}

.bundle-option.selected {
  border: 2px solid #00a341;
  background: #eaf2ed;
}

.bundle-price {
  font-size: 20px;
  font-weight: bold;
}

.bundle-discount {
  color: #00a341;
  font-weight: 600;
  font-size: 14px;
}
</style>
{% endstylesheet %}

<div class="bundle-offer" id="bundle-offer">
  <h2>Regroupez & Économisez</h2>

  {% assign options = section.blocks | where: "type", "bundle_option" %}
  {% for block in options %}
    <label class="bundle-option {% if forloop.first %}selected{% endif %}" data-index="{{ forloop.index0 }}">
      <input type="radio" name="bundle_choice" value="{{ block.settings.title }}" {% if forloop.first %}checked{% endif %}>
      <div>
        <strong>{{ block.settings.title }}</strong>
        {% if block.settings.subtitle != blank %}
          <div>{{ block.settings.subtitle }}</div>
        {% endif %}
        {% if block.settings.discount != blank %}
          <div class="bundle-discount">-{{ block.settings.discount }}%</div>
        {% endif %}
      </div>
      <div class="bundle-price">
        {{ block.settings.price | money }}
      </div>
    </label>
  {% endfor %}
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const bundleOptions = document.querySelectorAll(".bundle-option");
    bundleOptions.forEach((option) => {
      option.addEventListener("click", function () {
        bundleOptions.forEach(o => o.classList.remove("selected"));
        option.classList.add("selected");
        option.querySelector('input[type="radio"]').checked = true;
      });
    });
  });
</script>

{% schema %}
{
  "name": "Offre groupée",
  "tag": "section",
  "class": "bundle-offer-section",
  "blocks": [
    {
      "type": "bundle_option",
      "name": "Option de bundle",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Titre",
          "default": "Single"
        },
        {
          "type": "text",
          "id": "subtitle",
          "label": "Sous-titre",
          "default": "1 unité"
        },
        {
          "type": "number",
          "id": "price",
          "label": "Prix (en centimes)",
          "default": 5990
        },
        {
          "type": "number",
          "id": "discount",
          "label": "Réduction (%)",
          "default": 0
        }
      ]
    }
  ],
  "max_blocks": 4,
  "presets": [
    {
      "name": "Offre groupée",
      "blocks": [
        {
          "type": "bundle_option",
          "settings": {
            "title": "Single",
            "subtitle": "1 unité",
            "price": 5990,
            "discount": 0
          }
        },
        {
          "type": "bundle_option",
          "settings": {
            "title": "Duo",
            "subtitle": "2 unités",
            "price": 10183,
            "discount": 15
          }
        }
      ]
    }
  ]
}
{% endschema %}
